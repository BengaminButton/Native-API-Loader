# Native-API-Loader: Rust Shellcode Runner

<p align="center">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Rust_programming_language_black_logo.svg/120px-Rust_programming_language_black_logo.svg.png" width="120">
</p>

> **Native-API-Loader** ‚Äî —ç—Ç–æ –±–∞–∑–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Native API Windows —á–µ—Ä–µ–∑ Rust. –ú—ã —É—Ö–æ–¥–∏–º –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ WinAPI (kernel32.dll) –∏ —Å–ø—É—Å–∫–∞–µ–º—Å—è –≤ `ntdll.dll`, —á—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å—Å—è –≤—ã–¥–µ–ª—è—Ç—å –ø–∞–º—è—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –Ω–∞ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ.

---

## üöÄ –ü–æ—á–µ–º—É Rust?

–í 2025 –≥–æ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∞–¥–µ—Ä–æ–≤ –Ω–∞ Python/C# ‚Äî —ç—Ç–æ –ª–∏—à–Ω–∏–π —à—É–º –¥–ª—è EDR. Rust –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç:
- **Zero Runtime**: –ß–∏—Å—Ç—ã–π –Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–¥.
- **Memory Safety**: –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–ø–æ–∫–∞ –≤—ã –Ω–µ –≤ `unsafe`).
- **Low-level Control**: –£–¥–æ–±–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∏ —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ —Å `VirtualAlloc`, —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Native API**:
- **`NtAllocateVirtualMemory`**: –ü—Ä—è–º–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ `ntdll`.
- **Intrinsics**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ptr::copy_nonoverlapping` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
- **LLVM Optimization**: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Å—Ç—Ä–∏–ø–ø–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –±–∏–ª–¥–∞.

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∏–Ω–∞—Ä–Ω–∏–∫–∞

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ —ç–Ω—Ç—Ä–æ–ø–∏—é (—Å–º. `Cargo.toml`):
- `opt-level = "z"` (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É)
- `lto = true` (Link Time Optimization)
- `strip = true` (—É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
- `panic = "abort"` (—É–º–µ–Ω—å—à–µ–Ω–∏–µ –æ–≤–µ—Ä—Ö–µ–¥–∞)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `src/main.rs` ‚Äî –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞: –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ-—Ö–µ–Ω–¥–ª–∞, –≤—ã–¥–µ–ª–µ–Ω–∏–µ RWX –ø–∞–º—è—Ç–∏ (Native API), –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —à–µ–ª–ª–∫–æ–¥–∞ –∏ –∑–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞.
- `Cargo.toml` ‚Äî –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`ntapi`, `winapi`, `windows`) –∏ –ø—Ä–æ—Ñ–∏–ª–∏ —Å–±–æ—Ä–∫–∏.

## ‚ö†Ô∏è OPSEC –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–≠—Ç–æ—Ç –∫–æ–¥ —è–≤–ª—è–µ—Ç—Å—è **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º** –∏ —É—á–µ–±–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º. –î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á —Å–ª–µ–¥—É–µ—Ç:
1. **RW -> RX**: –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É `PAGE_EXECUTE_READWRITE`. –°–Ω–∞—á–∞–ª–∞ –≤—ã–¥–µ–ª—è–π—Ç–µ `READ_WRITE`, –∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ, –∞ –∑–∞—Ç–µ–º –º–µ–Ω—è–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ `EXECUTE_READ` —á–µ—Ä–µ–∑ `NtProtectVirtualMemory`.
2. **Direct Syscalls**: –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –ø—Ä—è–º–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (Hell's Gate / Tartarus' Gate), —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ —Ö—É–∫–∏ `ntdll`.
3. **Encryption**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ —à–µ–ª–ª–∫–æ–¥ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º XOR –∏–ª–∏ AES.

## üî® –°–±–æ—Ä–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
git clone https://github.com/BengaminButton/Native-API-Loader
cd Native-API-Loader

# –°–±–æ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–ª–∏–∑–∞
cargo build --release
```

---
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫**: [BenjaminButton](https://benjaminbutton.ru)
**–ü—Ä–æ–µ–∫—Ç**: [Xillen Stealer](https://t.me/XillenStealer)

**–î–∏—Å–∫–ª–µ–π–º–µ—Ä**: –î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ª—é–±–æ–π —É—â–µ—Ä–±, –ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞.
